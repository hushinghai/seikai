/**
 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
 *
 * @version 1.0.1
 * @codingstandard ftlabs-jsv2
 * @copyright The Financial Times Limited [All Rights Reserved]
 * @license MIT License (see LICENSE.txt)
 */
function FastClick(a,b){"use strict";function c(a,b){return function(){return a.apply(b,arguments)}}var d;if(b=b||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=b.touchBoundary||10,this.layer=a,this.tapDelay=b.tapDelay||200,!FastClick.notNeeded(a)){for(var e=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],f=this,g=0,h=e.length;h>g;g++)f[e[g]]=c(f[e[g]],f);deviceIsAndroid&&(a.addEventListener("mouseover",this.onMouse,!0),a.addEventListener("mousedown",this.onMouse,!0),a.addEventListener("mouseup",this.onMouse,!0)),a.addEventListener("click",this.onClick,!0),a.addEventListener("touchstart",this.onTouchStart,!1),a.addEventListener("touchmove",this.onTouchMove,!1),a.addEventListener("touchend",this.onTouchEnd,!1),a.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(a.removeEventListener=function(b,c,d){var e=Node.prototype.removeEventListener;"click"===b?e.call(a,b,c.hijacked||c,d):e.call(a,b,c,d)},a.addEventListener=function(b,c,d){var e=Node.prototype.addEventListener;"click"===b?e.call(a,b,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),d):e.call(a,b,c,d)}),"function"==typeof a.onclick&&(d=a.onclick,a.addEventListener("click",function(a){d(a)},!1),a.onclick=null)}}define("eventbrite",["require","eb/csrfcookie"],function(a){"use strict";return a("eb/csrfcookie"),window.EB});var deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(a){"use strict";switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===a.type||a.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(a.className)},FastClick.prototype.needsFocus=function(a){"use strict";switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},FastClick.prototype.sendClick=function(a,b){"use strict";var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},FastClick.prototype.determineEventType=function(a){"use strict";return deviceIsAndroid&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(a){"use strict";var b;deviceIsIOS&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},FastClick.prototype.updateScrollParent=function(a){"use strict";var b,c;if(b=a.fastClickScrollParent,!b||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(a){"use strict";return a.nodeType===Node.TEXT_NODE?a.parentNode:a},FastClick.prototype.onTouchStart=function(a){"use strict";var b,c,d;if(a.targetTouches.length>1)return!0;if(b=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],deviceIsIOS){if(d=window.getSelection(),d.rangeCount&&!d.isCollapsed)return!0;if(!deviceIsIOS4){if(c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<this.tapDelay&&a.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(a){"use strict";var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c?!0:!1},FastClick.prototype.onTouchMove=function(a){"use strict";return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},FastClick.prototype.findControl=function(a){"use strict";return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(a){"use strict";var b,c,d,e,f,g=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,c=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(f=a.changedTouches[0],g=document.elementFromPoint(f.pageX-window.pageXOffset,f.pageY-window.pageYOffset)||g,g.fastClickScrollParent=this.targetElement.fastClickScrollParent),d=g.tagName.toLowerCase(),"label"===d){if(b=this.findControl(g)){if(this.focus(g),deviceIsAndroid)return!1;g=b}}else if(this.needsFocus(g))return a.timeStamp-c>100||deviceIsIOS&&window.top!==window&&"input"===d?(this.targetElement=null,!1):(this.focus(g),this.sendClick(g,a),deviceIsIOS&&"select"===d||(this.targetElement=null,a.preventDefault()),!1);return deviceIsIOS&&!deviceIsIOS4&&(e=g.fastClickScrollParent,e&&e.fastClickLastScrollTop!==e.scrollTop)?!0:(this.needsClick(g)||(a.preventDefault(),this.sendClick(g,a)),!1)},FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(a){"use strict";return this.targetElement?a.forwardedTouchEvent?!0:a.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(a){"use strict";var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail?!0:(b=this.onMouse(a),b||(this.targetElement=null),b)},FastClick.prototype.destroy=function(){"use strict";var a=this.layer;deviceIsAndroid&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(a){"use strict";var b,c;if("undefined"==typeof window.ontouchstart)return!0;if(c=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(c>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}return"none"===a.style.msTouchAction?!0:!1},FastClick.attach=function(a,b){"use strict";return new FastClick(a,b)},"undefined"!=typeof define&&define.amd?define("vendor/fastclick-1.0.1",[],function(){"use strict";return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,/**
* hoverIntent is similar to jQuery's built-in "hover" function except that
* instead of firing the onMouseOver event immediately, hoverIntent checks
* to see if the user's mouse has slowed down (beneath the sensitivity
* threshold) before firing the onMouseOver event.
* 
* hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* hoverIntent is currently available for use in all personal or commercial 
* projects under both MIT and GPL licenses. This means that you can choose 
* the license that best suits your project, and use it accordingly.
* 
* // basic usage (just like .hover) receives onMouseOver and onMouseOut functions
* $("ul li").hoverIntent( showNav , hideNav );
* 
* // advanced usage receives configuration object only
* $("ul li").hoverIntent({
*	sensitivity: 7, // number = sensitivity threshold (must be 1 or higher)
*	interval: 100,   // number = milliseconds of polling interval
*	over: showNav,  // function = onMouseOver callback (required)
*	timeout: 0,   // number = milliseconds delay before onMouseOut function call
*	out: hideNav    // function = onMouseOut callback (required)
* });
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne brian(at)cherne(dot)net
*/
function(a){a.fn.hoverIntent=function(b,c){var d={sensitivity:7,interval:100,timeout:0};d=a.extend(d,c?{over:b,out:c}:b);var e,f,g,h,i=function(a){e=a.pageX,f=a.pageY},j=function(b,c){return c.hoverIntent_t=clearTimeout(c.hoverIntent_t),Math.abs(g-e)+Math.abs(h-f)<d.sensitivity?(a(c).unbind("mousemove",i),c.hoverIntent_s=1,d.over.apply(c,[b])):(g=e,h=f,c.hoverIntent_t=setTimeout(function(){j(b,c)},d.interval),void 0)},k=function(a,b){return b.hoverIntent_t=clearTimeout(b.hoverIntent_t),b.hoverIntent_s=0,d.out.apply(b,[a])},l=function(b){var c=jQuery.extend({},b),e=this;e.hoverIntent_t&&(e.hoverIntent_t=clearTimeout(e.hoverIntent_t)),"mouseenter"==b.type?(g=c.pageX,h=c.pageY,a(e).bind("mousemove",i),1!=e.hoverIntent_s&&(e.hoverIntent_t=setTimeout(function(){j(c,e)},d.interval))):(a(e).unbind("mousemove",i),1==e.hoverIntent_s&&(e.hoverIntent_t=setTimeout(function(){k(c,e)},d.timeout)))};return this.bind("mouseenter",l).bind("mouseleave",l)}}(jQuery),define("jquery.hoverintent",function(){}),define("require/apps/global_nav/global_nav",["require","underscore","jquery","eventbrite","vendor/fastclick-1.0.1","jquery.hoverintent"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=a("eventbrite"),e=a("vendor/fastclick-1.0.1");return a("jquery.hoverintent"),{init:function(){window._EB_GLOBAL_HEADER_INITED=!0,b.bindAll(this),this.options={actionItemLock:!0,hoverIntentOptions:{over:this.showDropDown,out:this.hideDropdown,timeout:300}},this.selectors={actionContainer:".js-gh-dd",actionItem:".js-gh-action",actionActive:"active",menuItem:".js-gh-dd-menu",menuShowClass:"js-gh-dd-menu--show",backgroundMask:"show-menu-mask",menuLockClass:"locked"},this.touchSupport="object"==typeof Touch;for(var a=c(this.selectors.actionContainer),d=this.toggleDropDown,f=0;f<a.length;f++)e.attach(a[f]);this.touchSupport||(d=this.options.actionItemLock?this.toggleDropDown:this.preventClick,this.bindHoverIntent(c(this.selectors.actionContainer))),c(".global-mask").on("click touchstart",c.proxy(function(a){a.preventDefault(),this.globalReset(a)},this)),c(this.selectors.actionItem).on("click",d),c(".js-search-query-area").bind("autocomplete:renderedView",this.autocompleteRendered),c("body").on("click",this.globalReset),this.initializeMixpanelTracking()},initializeMixpanelTracking:function(){c(".js-mx-track-click").on("click",function(a){var b=a.target,c=b.getAttribute("data-mixpanel-action"),e=b.getAttribute("data-mixpanel-interaction-type"),f=b.getAttribute("data-mixpanel-element-name"),g=b.getAttribute("data-mixpanel-logged-in-status"),h=b.getAttribute("data-mixpanel-internal-click"),i={"Interaction Type":e,"Element Name":f,"Logged In Status":g,"Page Origin":window.location.href};h?d.Analytics.trackInternalLink(c,i):d.Analytics.track(c,i)})},showDropDown:function(a){this.hideAllDropDowns();var b=this._getElements(a);b.actionItem.addClass(this.selectors.actionActive),b.menuItem.addClass(this.selectors.menuShowClass),this.showMask()},hideDropdown:function(a){var b=this._getElements(a);b.actionItem.removeClass(this.selectors.actionActive),b.menuItem.removeClass(this.selectors.menuShowClass),this.hideMask()},hideAllDropDowns:function(){var a=c(this.selectors.actionItem);a.removeClass(this.selectors.actionActive),c(this.selectors.menuItem).removeClass(this.selectors.menuShowClass),this.hideMask(),this.options.actionItemLock&&!this.touchSupport&&this.bindHoverIntent(c(this.selectors.actionContainer)),a.removeClass(this.selectors.menuLockClass)},toggleDropDown:function(a){a.preventDefault();var b=this._getElements(a);if(b.actionItem.hasClass(this.selectors.menuLockClass))this.hideAllDropDowns();else if(this.showDropDown(a),b.actionItem.addClass(this.selectors.menuLockClass),this.options.actionItemLock&&!this.touchSupport){var d=c(a.currentTarget).closest(this.selectors.actionContainer);this.unbindHoverIntent(d)}},globalReset:function(a){var b=a.target?a.target:a.toElement;this._isDropDownElement(b)||this.hideAllDropDowns()},showMask:function(){c("body").addClass(this.selectors.backgroundMask)},hideMask:function(){c("body").removeClass(this.selectors.backgroundMask)},_getElements:function(a){var b=c(a.currentTarget),d=b.children(this.selectors.actionItem),e=b.children(this.selectors.menuItem);return d.length||(d=b,e=b.next(this.selectors.menuItem)),{actionItem:d,menuItem:e}},_isDropDownElement:function(a){return c(a).closest(".js-gh-dd-menu, .js-gh-action").length?!0:!1},preventClick:function(a){a.preventDefault()},bindHoverIntent:function(a){a.hoverIntent(this.options.hoverIntentOptions)},unbindHoverIntent:function(a){a.unbind("mouseenter").unbind("mouseleave"),a.removeProp("hoverIntent_t"),a.removeProp("hoverIntent_s")},autocompleteRendered:function(a,b){var d=c(".js-global-header"),e=c("body");b.active?(d.addClass("search-autocomplete-is-active"),e.addClass("show-search-mask")):(d.removeClass("search-autocomplete-is-active"),e.removeClass("show-search-mask"))}}}),function(a,b,c,d,e){"use strict";b.ComponentFactory=function(){},d.extend(b.ComponentFactory.prototype,{bindMethods:function(a,b){d.each(a,function(a,c,e){"function"==typeof a&&(e[c]=d.bind(a,b))})},createComponent:function(a){var b=d.extend({},e.Events),c=d.clone(this.commands)||{},f=d.clone(this.requests)||{},g=d.clone(this.componentMethods)||{},h=d.clone(this.sandbox)||{};return this.preCreate.call(b,a),b.sandbox=h,b.commands=new e.Wreqr.Commands,b.reqres=new e.Wreqr.RequestResponse,this.bindMethods(c,b),this.bindMethods(f,b),this.bindMethods(g,b),b=d.extend(b,g),b.commands.setHandlers(c),b.reqres.setHandlers(f),b.sandbox.execute=d.bind(b.commands.execute,b.commands),b.sandbox.request=d.bind(b.reqres.request,b.reqres),b.start=d.bind(this.start,b),b.stop=d.bind(this.stop,b),this.postCreate.call(b,a),b},create:function(a){var b=this.createComponent(a);return this.initialize.call(b,a),b},preCreate:function(){},postCreate:function(){},initialize:function(){},start:function(){},stop:function(){}}),b.ComponentFactory.extend=e.Model.extend,b.ComponentFactory.create=function(a){return(new this).create(a)},"function"==typeof define&&define("eb/_backbone/component_factory",["require","backbone_wreqr","backbone_advice"],function(a){a("backbone_wreqr");var c=a("backbone_advice");return c.addMixin(b.ComponentFactory),b.ComponentFactory})}(jQuery,EB,window,window._,window.Backbone),define("require/mixins/autocomplete_mixin",["require","jquery","jquery_autocomplete"],function(a){"use strict";var b=a("jquery");return a("jquery_autocomplete"),function(a){a._highlightText=function(a,c){var d,e;return d=b.ui.autocomplete.escapeRegex(c).split("\\ "),e=new RegExp("("+d.join("|")+")","ig"),a.replace(e,'<span class="text-body--significant">$1</span>')},a._renderItem=function(a,c){return b("<li></li>").data("item.autocomplete",c).append(b("<a></a>").html(c.label)).appendTo(a)},a._populateAutocomplete=function(){b(this).autocomplete("search")}}}),define("gettext",["require"],function(){"use strict";return window.gettext}),define("require/entities/search_autocomplete_collection",["require","underscore","eventbrite","require/mixins/autocomplete_mixin","gettext"],function(a){"use strict";var b=a("underscore"),c=a("eventbrite"),d=a("require/mixins/autocomplete_mixin"),e=a("gettext");return c.Backbone.Collection.extend({url:"/directory/autocomplete/",initialize:function(a){b.bindAll(this,"_parseAutocompleteItem","_addAutocompleteItemToCollection","getAutocompleteData"),this.loc=a.loc,this.term=a.term,new d(this)},parse:function(a){this.autocompleteData=[],a.version?(this.currCategory=this.loc.split(",")[0]+" "+e("Events"),this.currType="Event",b.each(a.events,this._addAutocompleteItemToCollection),this.currCategory=e("Organizers"),this.currType="Organizer",b.each(a.organizers,this._addAutocompleteItemToCollection),this.currCategory=e("Categories"),this.currType="Category",b.each(a.categories,this._addAutocompleteItemToCollection),this.currCategory=e("Popular Queries"),this.currType="Popular Query",b.each(a.popular_queries,this._addAutocompleteItemToCollection)):(this.currCategory=this.loc.split(",")[0]+" "+e("Events"),this.autocompleteData=b(a.events).map(this._parseAutocompleteItem),a.top_match&&a.top_match.events_name&&(this.currCategory=e("Worldwide Events"),this.autocompleteData.push(this._parseAutocompleteItem(a.top_match))))},_addAutocompleteItemToCollection:function(a,b){this.autocompleteData.push(this._parseAutocompleteItem(a,b))},_parseAutocompleteItem:function(a,b){var c=a.events_name||a.name,d=a.events_id||a.id,e={label:this._highlightText(c,this.term),value:c,url:a.url||a.resource_uri,source:"autocomp",sourceID:a.source_id,id:d,rank:b,type:this.currType,category:this.currCategory};return e},getAutocompleteData:function(){return this.autocompleteData}})}),window.EB=window.EB||{},EB.util=function(a,b){"use strict";var c=/(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?/,d=/(?:(.+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?/;return{truncate:function(a,b){return"string"!=typeof a?"":b>3&&a.length>b?a.slice(0,b-3)+"...":a},sort:function(a){return a.split("").sort().join("")},getCookie:function(b){var c=null;if(document.cookie&&""!==document.cookie)for(var d=document.cookie.split(";"),e=0;e<d.length;e++){var f=a.trim(d[e]);if(f.substring(0,b.length+1)===b+"="){c=decodeURIComponent(f.substring(b.length+1));break}}return c},unshuffle:function(a,b){var c,d={};a=a.toLowerCase(),c=this.sort(a);for(var e=0;e<b.length;e++){var f=b[e].toLowerCase();d[this.sort(f)]=f}return d.hasOwnProperty(c)?d[c]:a},parseUrl:function(a,b){var e={},f=["url","scheme","slash","host","port","path","query","fragment"],g=b?d.exec(a):c.exec(a);if(null!==g)for(var h=0;h<f.length;h++)e[f[h]]=g[h];return e},looksLikeUrl:function(a){var c,d=b.util.parseUrl(a,!0);return d.scheme?!0:d.host&&(c=d.host.split("."),c.length>1&&""!==c[1])?!0:!1},scrollToElement:function(b){var c=b.offset();c&&c.top&&a("body, html").animate({scrollTop:c.top-25})},h:function(a){var b,c={},d=96,e=27;if(arguments.length>e)throw new Error("EB.Util.h received too many arguments. Got: "+arguments.length);for(var f=1;f<arguments.length;f++)c[String.fromCharCode(d+f)]=arguments[f];return b=Handlebars.compile(a),b(c)}}}(window.jQuery,EB),define("eb/util",function(){}),define("require/components/search_autocomplete/search_input_view",["require","underscore","jquery","backbone","eventbrite","eb/analytics","require/entities/search_autocomplete_collection","require/mixins/autocomplete_mixin","gettext","eb/util","jquery_autocomplete"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=a("backbone"),e=a("eventbrite"),f=a("eb/analytics"),g=a("require/entities/search_autocomplete_collection"),h=a("require/mixins/autocomplete_mixin"),i=a("gettext");return a("eb/util"),a("jquery_autocomplete"),d.View.extend({events:{"focus .js-search-query-input":"handleSearchQueryFocus","blur .js-search-query-input":"handleSearchQueryBlur","click .js-header-search-icon":"handleHeaderSearchIconClick","keyup .js-search-query-input":"handleQueryKeydown","paste .js-search-query-input":"handleQueryPaste","click .js-search-submit":"handleFormSubmit"},initialize:function(a){b.bindAll(this,"handleSearchQueryFocus","handleSearchQueryBlur","getSuggestions","handleSelectEvent","renderAutocompleteMenu","hideAutocomplete","handleQueryKeydown","triggerQueryInputFocus","setSearchInitStatus"),this.sandbox=a.sandbox,new h(this),this.$searchQueryArea=this.$(".js-search-query-area"),this.$searchQueryInput=this.$(".js-search-query-input"),this.$searchQueryIcon=this.$(".js-search-query-icon"),this.$searchQueryInput.length&&(this.autocompleteQuerySuggestions=new g({loc:this.sandbox.request("autocomplete:location")}),this.sandbox.searchQuery=this.$searchQueryInput.val(),this.initializeEventsAutocomplete(),this.setSearchInitStatus())},setSearchInitStatus:function(){this.searchStarted=!1,this.resultsDisplayed=!1},initializeEventsAutocomplete:function(){this.$searchQueryInput.autocomplete({appendTo:this.$el,minLength:0,select:this.handleSelectEvent,source:this.getSuggestions,position:{my:"left top",at:"left bottom",of:this.$el},delay:100}).focus(this._populateAutocomplete).data("autocomplete")._renderMenu=this.renderAutocompleteMenu},renderDefaultView:function(){this.$searchQueryArea.addClass("show-large"),this.$el.removeClass("is-active sill sill--with-borders"),this.$searchQueryArea.trigger("autocomplete:renderedView",{active:!1}),this.$searchQueryInput[0].blur()},renderQueryInputView:function(){this.$searchQueryArea.removeClass("show-large"),this.$el.addClass("is-active sill sill--with-borders"),this.$searchQueryArea.trigger("autocomplete:renderedView",{active:!0})},renderAutocompleteMenu:function(a,b){var d=this,f="";a.removeClass("ui-menu ui-widget ui-widget-content ui-corner-all"),a.addClass("list sill sill--with-borders search-query-autocomplete"),c.each(b,function(b,c){c.category!==f&&c.category&&(a.append(e.util.h('<p class="list--divider">{{a}}</p>',c.category)),f=c.category),a.append(d._renderItem(a,c))}),this.trackResultsDisplayed(b)},hideAutocomplete:function(){this.$searchQueryInput.trigger("blur"),this.$searchQueryInput.autocomplete("disable")},handleHeaderSearchIconClick:function(a){a.preventDefault(),this.sandbox.request("autocomplete:isInteracting")?this.sandbox.execute("autocomplete:interaction:stop"):this.sandbox.execute("autocomplete:interaction:start")},trackSearchStart:function(){this.searchStarted||(f.analyticsAction("SearchStartAction",{},{}),this.searchStarted=!0)},trackResultsDisplayed:function(a){this.searchStarted&&!this.resultsDisplayed&&(f.analyticsAction("AutocompleteResultViewAction",{},{}),this.resultsDisplayed=!0),this.sandbox.searchQuery.length>=2&&f.track("Autocomplete Results Displayed",{"Search Query":this.sandbox.searchQuery,Location:this.sandbox.searchLocation,"Result Source":"Autocomplete","Number of Results":a.length})},trackSearchStop:function(){this.resultsDisplayed&&f.analyticsAction("SearchAbandonedAction",{search_terms:this.$searchQueryInput.val(),search_location:this.sandbox.request("autocomplete:location")},{}),this.setSearchInitStatus()},handleSearchQueryFocus:function(){this.sandbox.execute("autocomplete:interaction:start"),this.$searchQueryArea.addClass("has-focus"),this.$searchQueryIcon.addClass("is-focus"),this.$searchQueryInput.autocomplete("enable")},handleSearchQueryBlur:function(){this.$searchQueryArea.removeClass("has-focus"),this.$searchQueryIcon.removeClass("is-focus")},handleQueryKeydown:function(a){13===a.which&&this.handleFormSubmit(a),this.handleQueryInput(),this.trackSearchStart()},handleQueryPaste:function(){this.$searchQueryInput.trigger("keydown")},handleQueryInput:function(){this.sandbox.searchQuery=this.$searchQueryInput.val()},handleSelectEvent:function(a,b){a.preventDefault(),this.sandbox.execute("autocomplete:query:suggestionSelected",b.item)},handleFormSubmit:function(){f.analyticsAction("SearchEventsClickAction",{source:"globalheader"},{}),this.setSearchInitStatus()},triggerQueryInputFocus:function(){this.$searchQueryInput.trigger("focus")},getSuggestions:function(a,b){var c={q:this.$searchQueryInput.val(),loc:this.sandbox.request("autocomplete:location")},d=this.autocompleteQuerySuggestions;d.term=this.$searchQueryInput.val(),d.loc=this.sandbox.request("autocomplete:location"),d.term.length<2?b([{type:"Category",category:i("Categories"),label:i("Arts"),source:"autocomp",url:"/directory?cat=Arts",value:"Arts"},{type:"Category",category:i("Categories"),label:i("Business"),source:"autocomp",url:"/directory?cat=Business",value:"Business"},{type:"Category",category:i("Categories"),label:i("Charity & Causes"),source:"autocomp",url:"/directory?cat=Charity%20%26%20Causes",value:"Charity & Causes"},{type:"Category",category:i("Categories"),label:i("Community"),source:"autocomp",url:"/directory?cat=Community",value:"Community"},{type:"Category",category:i("Categories"),label:i("Film & Media"),source:"autocomp",url:"/directory?cat=Film%20%26%20Media",value:"Film & Media"},{type:"Category",category:i("Categories"),label:i("Food & Drink"),source:"autocomp",url:"/directory?cat=Food%20%26%20Drink",value:"Food & Drink"},{type:"Category",category:i("Categories"),label:i("Music"),source:"autocomp",url:"/directory?cat=Music",value:"Music"},{type:"Category",category:i("Categories"),label:i("All Categories"),source:"autocomp",url:"/directory",value:"All Categories"}]):d.fetch({reset:!0,data:c}).done(function(){b(d.getAutocompleteData())})}})}),define("jquery_cookie",["require"],function(){"use strict";return window.jQuery.cookie}),define("require/components/search_autocomplete/search_location_view",["require","jquery","require/mixins/autocomplete_mixin","underscore","backbone","gettext","require/core/bootstrap","jquery_autocomplete","jquery_cookie"],function(a){"use strict";var b=a("jquery"),c=a("require/mixins/autocomplete_mixin"),d=a("underscore"),e=a("backbone"),f=a("gettext");return a("require/core/bootstrap"),a("jquery_autocomplete"),a("jquery_cookie"),e.View.extend({events:{"focus .js-search-location-input":"handleLocationInputFocus","blur .js-search-location-input":"handleLocationInputBlur","keydown .js-search-location-input":"handleLocationInput"},initialize:function(a){d.bindAll(this,"renderDefaultView","renderDisplayView","renderAutocompleteMenu","initializeGoogleLocationAutocomplete","serializeData","getSuggestions","handleAutocompletePlaceChange"),this.sandbox=a.sandbox,new c(this)},initializeGoogleLocationAutocomplete:function(){"undefined"!=typeof google&&"undefined"!=typeof google.maps.places&&"undefined"!=typeof google.maps.places.AutocompleteService?(this.$searchLocationInput.off("click",this.initializeGoogleLocationAutocomplete),this.googleLocationAutocomplete=new google.maps.places.AutocompleteService,this.$searchLocationInput.autocomplete({appendTo:this.$el,minLength:2,select:this.handleAutocompletePlaceChange,source:this.getSuggestions,position:{my:"left top",at:"left bottom",of:this.$el},delay:100}).data("autocomplete")._renderMenu=this.renderAutocompleteMenu):this.$searchLocationInput.on("focus",this.initializeGoogleLocationAutocomplete)},serializeData:function(){return{searchLocation:this.sandbox.searchLocation}},render:function(){this.$searchLocationEdit=this.$(".js-search-location-edit"),this.$searchLocationInput=this.$(".js-search-location-input"),this.$searchLocationIcon=this.$(".js-search-location-icon"),this.$searchLocationInput.length&&(this.sandbox.searchLocation=this.$searchLocationInput.val(),this.initializeGoogleLocationAutocomplete(),this.renderDefaultView())},renderDefaultView:function(){this.$el.addClass("is-hidden")},renderDisplayView:function(){this.$el.removeClass("is-hidden")},handleLocationInputFocus:function(){this.$searchLocationIcon.addClass("is-focus"),this.$searchLocationInput.val("").trigger("keyup"),this.sandbox.execute("autocomplete:navigate:location")},handleLocationInputBlur:function(){this.$searchLocationIcon.removeClass("is-focus"),this.$searchLocationInput.val()||this.$searchLocationInput.val(f(this.sandbox.request("autocomplete:location")))},handleLocationInput:function(a){return this.sandbox.searchLocation=this.$searchLocationInput.val(),13===a.which?(this.handleLocationChanged(),!1):void 0},handleLocationChanged:function(){b.cookie("loc",this.sandbox.searchLocation,{path:"/",expires:1}),this.sandbox.execute("autocomplete:location:changed")},getSuggestions:function(a,b){this.sandbox.searchLocation=a.term,0===this.sandbox.searchLocation.length?this.sandbox.searchLocation=f("Worldwide"):this.googleLocationAutocomplete.getPlacePredictions({input:this.sandbox.searchLocation,types:["(regions)"]},function(a){b(a)})},renderAutocompleteMenu:function(a,c){var d=this;a.removeClass("ui-menu ui-widget ui-widget-content ui-corner-all"),a.addClass("list sill sill--with-borders"),b.each(c,function(b,c){c.label=d._highlightText(c.description,d.sandbox.searchLocation),c.value=c.description,a.append(d._renderItem(a,c))})},handleAutocompletePlaceChange:function(a,b){return a.stopPropagation(),this.sandbox.searchLocation=b.item.description,this.$searchLocationInput.val(this.sandbox.searchLocation),this.handleLocationChanged(),!1}})}),define("require/components/search_autocomplete/component",["require","jquery","backbone","eventbrite","marionette","eb/_backbone/component_factory","require/components/search_autocomplete/search_input_view","require/components/search_autocomplete/search_location_view","eb/analytics","gettext"],function(a){"use strict";var b=a("jquery"),c=a("backbone"),d=(a("eventbrite"),a("marionette"),a("eb/_backbone/component_factory")),e=a("require/components/search_autocomplete/search_input_view"),f=a("require/components/search_autocomplete/search_location_view"),g=a("eb/analytics"),h=a("gettext");return h||(h=function(a){return a}),jQuery.fn.extend({propAttr:b.fn.prop||b.fn.attr}),d.extend({initialize:function(a){this.initializeSearch(a),this.initializeViews(a)},componentMethods:{initializeSearch:function(){this.isSearchPage=!1,this.isInteracting=!1,this.sandbox.searchQuery="",this.sandbox.searchLocation=""},initializeViews:function(a){this.searchAutocompleteView=new e({el:a.el,sandbox:this.sandbox}),this.searchAutocompleteView.render(),this.searchLocationView=new f({el:".js-header-location-autocomplete",sandbox:this.sandbox}),this.searchLocationView.render()},eventHandler:function(a){this.searchAutocompleteView.$el.find(a.target).length<1&&(b(a.target).hasClass("ui-page")||this.sandbox.execute("autocomplete:interaction:stop"))}},commands:{"autocomplete:interaction:start":function(){this.isInteracting||(b("body").on("click focusin touchstart",this.eventHandler),this.isInteracting=!0,this.sandbox.execute("autocomplete:navigate:query")),this.searchLocationView.renderDisplayView()},"autocomplete:interaction:stop":function(){this.searchAutocompleteView.renderDefaultView(),this.searchLocationView.renderDefaultView(),this.searchAutocompleteView.hideAutocomplete(),b("body").off("click focusin touchstart",this.eventHandler),this.isInteracting=!1,this.searchAutocompleteView.trackSearchStop()},"autocomplete:navigate:query":function(){this.searchAutocompleteView.renderQueryInputView(),this.searchAutocompleteView.triggerQueryInputFocus()},"autocomplete:navigate:location":function(){this.searchAutocompleteView.hideAutocomplete(),this.searchAutocompleteView.renderQueryInputView()},"autocomplete:query:suggestionSelected":function(a){g.trackInternalNavigationAction("AutocompleteResultClickAction",{public_event_id:a.id,autocomp_suggestion:a.value,autocomp_type:a.type,rank:a.rank,source_id:a.sourceID,search_terms:this.searchAutocompleteView.$searchQueryInput.val(),search_location:this.sandbox.request("autocomplete:location")},{});var b={"Search Query":this.sandbox.searchQuery,"Map Filtered":"Worldwide"!==this.sandbox.request("autocomplete:location"),Location:this.sandbox.searchLocation,Rank:a.rank,"Number of Results":this.searchAutocompleteView.$el.find("li").length};b["Result Type"]=a.category.split(" ").pop(),g.trackInternalLink("Autocomplete Result Clicked",b),window.location=a.url},"autocomplete:location:changed":function(){c.trigger("headerLocationChange"),this.sandbox.execute("autocomplete:navigate:query"),g.track("Location Changed",{Source:"Global header input box"})}},requests:{"autocomplete:location":function(){return this.sandbox.searchLocation=this.sandbox.searchLocation.replace(/^[ ]+|[ ]+$/g,""),this.sandbox.searchLocation===h("Worldwide")?"Worldwide":this.sandbox.searchLocation===h("Current Location")||""===this.sandbox.searchLocation||void 0===this.sandbox.searchLocation?"Current Location":this.sandbox.searchLocation},"autocomplete:query":function(){return this.sandbox.searchQuery},"autocomplete:isInteracting":function(){return this.isInteracting}}})}),define("require/components/analytics/track_event",["require","dorsal","jquery","eb/analytics"],function(a){"use strict";var b=a("dorsal"),c=a("jquery"),d=a("eb/analytics"),e=function(a,b){var e=c(a.currentTarget),f={category:e.data("eventCategory"),action:e.data("eventAction"),label:e.data("eventLabel")};b?d.trackEventFromLink(f):d.trackEvent(f)};b.registerPlugin("track-event-links",{create:function(a){c(a.el).on("click",".js-xd-track-event",function(a){e(a,!1)}).on("click",".js-xd-track-link",function(a){e(a,!0)})}})}),require(["eb/require_base_config","require/apps/global_nav/global_nav","require/components/search_autocomplete/component","eb-styleguide/js/ui_components/component_library","jquery","require/components/analytics/track_event"],function(a,b,c,d,e){"use strict";b.init(),e(function(){d.wireAll()}),window.searchAutocomplete=c.create({el:".js-header-search-autocomplete"})}),define("require/apps/global_nav/app",function(){});